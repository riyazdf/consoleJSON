<html>
    <head>
        <title>Console API examples</title>
        <script src="jquery.js"></script>
        <script src="consoleJSON.js"></script>
        <script>
          var theJSON;
          var theRuleset;
          $.getJSON("../code/example.json", function(json) {
                theJSON = json;
                /* 
                 *
                 * We have two calls to consoleJSON.log(), and 
                 * therefore two prints, to demonstrate the power of rulesets
                 *
                 * FIRST PRINT: 
                 *
                 * We instantiate a ruleset in which we change 
                 * global and keyed rules, for both style and formatting.
                 * 
                 * We compose rulesets by chaining addRule() and addGlobalRule(),
                 * in no particular order.
                 *
                 * The rules we compose:
                 * - global: make all string values green
                 * - global: make all numerical values red
                 * - bar: font size 30px
                 * - lorem: line length of 5 chars (the value wraps around)
                 *
                 * SECOND PRINT:
                 *
                 * We create a separate ruleset just for the subtree of foo:
                 * - foo: indent amount of 10 (this is inherited by its subtree)
                 * - foo.bar: font size 5px, note the specificity over just bar
                 * - foo.toad: font Impact, indent amount of 20
                 * - foo.toad.ribbit: collapse its grouping
                 *
                 * THIRD PRINT:
                 *
                 * We add the second ruleset to the first to compose a new one!
                 * We then print the JSON with the result ruleset, which will
                 * combine the two rules of the previous rulesets together and
                 * look as if the two previous prints were overlayed over each other!
                 *
                 * FOURTH PRINT:
                 *
                 * We now remove rules in a composable manner by chaining
                 * removeRule() and removeGlobalRule(), in no particular order
                 *
                 * The rules we remove:
                 * - global: make all numerical values red (now black)
                 * - foo: indent amount of 10 (now normal indent)
                 * - foo.toad: indent amount of 20 (now normal indent, still Impact)
                 * - foo.toad.ribbit: collapsed grouping (now expanded in console)
                 *
                 * Note: in this example we use strings to specify the params in the rules,
                 * but we've also included enum-style constants in consoleJSON, such as:
                 * consoleJSON.TYPES.STYLE for 'style'
                 *
                 */
                 console.log("First print the JSON with a global rule and two nested rules");
                 theRuleset = (new consoleJSON.Ruleset())
                          .addGlobalRule(['style','font_color','green','string'])
                          .addRule('bar', new consoleJSON.Rule('style','font_size','30px','string'))
                          .addRule('lorem', new consoleJSON.Rule('format','line_length',5,'all'));
                consoleJSON.log(theJSON, theRuleset);

                console.log("Now, we create a separate ruleset for the subtree of foo, as shown below:");
                var otherRuleset = (new consoleJSON.Ruleset())
                          .addRule('bar', new consoleJSON.Rule('style', 'font_size', '5px','string'))
                          .addRule('toad', new consoleJSON.Rule('style', 'font_family', 'Impact', 'all'))
                          .addRule('toad', new consoleJSON.Rule('format', 'indent_amt', 20, 'all'))
                          .addGlobalRule(new consoleJSON.Rule('format', 'indent_amt', 10, 'all'))
                          .addRule('toad.ribbit', new consoleJSON.Rule('format', 'collapse', true))
                          .addGlobalRule(['style', 'font_color', 'red', 'number']);
                consoleJSON.log(theJSON[0]['foo'], otherRuleset);

                console.log("We compose the previous two rulesets!  Note how the result looks like the previous two JSONs pasted together:")
                theRuleset.addRuleset('foo', otherRuleset);
                consoleJSON.log(theJSON, theRuleset);

                console.log("Now we remove some rules, both at the global and local level:")
                theRuleset.removeRule('foo.toad', new consoleJSON.Rule('format', 'indent_amt', 20, 'all'))
                          .removeRule('foo', new consoleJSON.Rule('format', 'indent_amt', 10, 'all'))
                          .removeGlobalRule(['style','font_color','green','string'])
                          .removeRule('lorem',new consoleJSON.Rule('format','line_length',5,'all'))
                          .removeRule('foo.toad.ribbit', new consoleJSON.Rule('format', 'collapse', true));
                consoleJSON.log(theJSON, theRuleset);
                
                console.log("check out the source for more details!");
          });
      </script>
    </head>
    <body>
        <h1 id="thirty">Open up your console to see the output examples</h1>
    </body>
    <script>
      var refresh = function() {
       h = window.innerHeight - 6;
       elemh = document.getElementById("thirty").offsetHeight;
       document.getElementById("thirty").style.paddingTop = (h - elemh)/2;
       document.getElementById("thirty").style.paddingBottom = (h - elemh)/2;
       };
      refresh();
    </script>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
    <style>
      html, body {
        padding: 0;
        margin: 0;
      }
      h1 {
        font-family: 'Open Sans', Helvetica;
        color: #efefef;
        background-color: rgba(0,0,0, .5);
        text-align: center;
        margin: 0;
      }
      body {
        background: url('http://lorempixel.com/g/1024/768');
        background-repeat: no-repeat;
        background-size: cover;
        background-position: center center;
      }
    </style>
</html>
